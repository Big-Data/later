
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Time Periods</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="BunKat">

    <!-- Le styles -->
    <link href="assets/css/bootstrap.min.css" rel="stylesheet">
    <link href="assets/css/docs.css" rel="stylesheet">
    <link href="assets/css/bootstrap-responsive.min.css" rel="stylesheet">

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="assets/js/html5shiv.js"></script>
    <![endif]-->

  </head>

  <body data-spy="scroll" data-target=".later-sidebar">

    <!-- Navbar
    ================================================== -->
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="brand" href="./index.html">Later</a>
          <div class="nav-collapse collapse">
            <ul class="nav">
              <li class="">
                <a href="./getting-started.html">Getting started</a>
              </li>
              <li class="active">
                <a href="./time-periods.html">Time periods</a>
              </li>
              <li class="">
                <a href="./modifiers.html">Modifiers</a>
              </li>
              <li class="">
                <a href="./schedules.html">Schedules</a>
              </li>
              <li class="">
                <a href="./parsers.html">Parsers</a>
              </li>
              <li class="">
                <a href="./occurrences.html">Occurrences</a>
              </li>
              <li class=>
                <a href="./execute.html">Execute</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>

<!-- Subhead
================================================== -->
<header class="jumbotron subhead" id="overview">
  <div class="container">
    <h1>Time Periods</h1>
    <p class="lead">Supported time periods for building schedules and performing
      time based calculations.</p>
  </div>
</header>


  <div class="container">

    <!-- Docs nav
    ================================================== -->
    <div class="row">
      <div class="span3 later-sidebar">
        <ul class="nav nav-list later-sidenav">
          <li><a href="#overview"><i class="icon-chevron-right"></i> Overview</a></li>
          <li><a href="#interface"><i class="icon-chevron-right"></i> Interface</a></li>
          <li><a href="#second"><i class="icon-chevron-right"></i> Second</a></li>
          <li><a href="#minute"><i class="icon-chevron-right"></i> Minute</a></li>
          <li><a href="#hour"><i class="icon-chevron-right"></i> Hour</a></li>
          <li><a href="#time"><i class="icon-chevron-right"></i> Time</a></li>
          <li><a href="#day"><i class="icon-chevron-right"></i> Day</a></li>
          <li><a href="#day-of-week"><i class="icon-chevron-right"></i> Day of week</a></li>
          <li><a href="#day-of-week-count"><i class="icon-chevron-right"></i> Day of week count</a></li>
          <li><a href="#day-of-year"><i class="icon-chevron-right"></i> Day of year</a></li>
          <li><a href="#week-of-month"><i class="icon-chevron-right"></i> Week of month</a></li>
          <li><a href="#iso-week-of-year"><i class="icon-chevron-right"></i> ISO Week of year</a></li>
          <li><a href="#month"><i class="icon-chevron-right"></i> Month</a></li>
          <li><a href="#year"><i class="icon-chevron-right"></i> Year</a></li>
          <li><a href="#custom"><i class="icon-chevron-right"></i> Custom</a></li>
        </ul>
      </div>
      <div class="span9">


        <!-- Overview
        ================================================== -->
        <section id="overview">
          <div>
            <h2>Overview</h2>
          </div>
          <p>Time periods are the crux of the Later library and are used to
            define new schedules. Later comes with a large
          assortment of time periods and is also fully extensible
          making it easy to create custom time periods.</p>
          <p>While time periods are primarily used by Later to define schedules and calculate
            occurrences, they are also useful for performing time based
            calculations. Calculating values such as ISO week number, moving
            between days of the year, or figuring out how many days are in a month are
            all possible using the time period interface.</p>
        </section>

        <!-- Interface
        ================================================== -->
        <section id="interface">
          <div>
            <h2>Interface</h2>
          </div>
          <p>All time periods implement the same public interface for interacting with them:</p>
          <dl>
          <dt>name</dt>
          <dd>The name of the time period.</dd>

          <dt>range</dt>
          <dd>The rough number of seconds that are covered when moving from one
            instance of this time period to the next instance.</dd>

          <dt>val(<i>date</i>)</dt>
          <dd>The value of this time period for the date specified.</dd>

          <dt>isValid(<i>date</i>, <i>value</i>)</dt>
          <dd>True if the specified value is valid for the specified date, false
            otherwise.</dd>

          <dt>extent(<i>date</i>)</dt>
          <dd>The minimum and maximum valid values for the time period for the
            specified date. If the minimum value is not 0, 0 can be specified
            to mean the maximum value. This makes working with non-constant
            extents (like days in a month) easier.</dd>

          <dt>start(<i>date</i>)</dt>
          <dd>The first second in which the value is the same as the value of
            the specified date. For example, the start of an hour would be the
            hour with 0 minutes and 0 seconds.</dd>

          <dt>end(<i>date</i>)</dt>
          <dd>The last second in which the value is the same as the value of
            the specified date. For example, the end of an hour would be the
            hour with 59 minutes and 59 seconds.</dd>

          <dt>next(<i>date</i>, <i>value</i>)</dt>
          <dd>Returns the next date where the value is the value specified. Sets the
            value to 1 if value specified is greater than the max allowed value.</dd>

          <dt>prev(<i>date</i>, <i>value</i>)</dt>
          <dd>Returns the previous date where the value is the value specified. Sets the
            value to the max allowed value if the value specified is greater than
            the max allowed value.</dd>
          </dl>

        </section>

        <!-- second
        ================================================== -->
        <section id="second">
          <div>
            <h2>Second <small>(second, s)</small></h2>
          </div>
          <p>Seconds in a minute, from 0 to 59.</p>
          <br/>
          <p>Using seconds in a schedule:</p>
<pre>
  var sched = {schedules: [{s: [0, 15, 30, 45]}]};
</pre>
          <br/>
          <p>Performing seconds based calculations:</p>
<pre>
  var d = new Date('2013-03-22T10:02:05Z');

  later.second.name;
  --> 'second'

  later.second.range;
  --> 1

  later.second.val(d);
  --> 5

  later.second.isValid(d, 10);
  --> false

  later.second.extent();
  --> [0, 59]

  later.second.start(d);
  --> 'Fri, 22 Mar 2013 10:02:05 GMT'

  later.second.end(d);
  --> 'Fri, 22 Mar 2013 10:02:05 GMT'

  later.second.next(d, 27);
  --> 'Fri, 22 Mar 2013 10:02:27 GMT'

  later.second.prev(d, 27);
  --> 'Fri, 22 Mar 2013 10:01:27 GMT'
</pre>

        </section>

        <!-- minute
        ================================================== -->
        <section id="minute">
          <div>
            <h2>Minute <small>(minute, m)</small></h2>
          </div>
          <p>Minutes in an hour, from 0 to 59.</p>
          <br/>
          <p>Using minutes in a schedule:</p>
<pre>
  var sched = {schedules: [{m: [0, 15, 30, 45]}]};
</pre>
          <br/>
          <p>Performing minutes based calculations:</p>
<pre>
  var d = new Date('2013-03-22T10:02:05Z');

  later.minute.name;
  --> 'minute'

  later.minute.range;
  --> 60

  later.minute.val(d);
  --> 2

  later.minute.isValid(d, 2);
  --> true

  later.minute.extent();
  --> [0, 59]

  later.minute.start(d);
  --> 'Fri, 22 Mar 2013 10:02:00 GMT'

  later.minute.end(d);
  --> 'Fri, 22 Mar 2013 10:02:59 GMT'

  later.minute.next(d, 27);
  --> 'Fri, 22 Mar 2013 10:27:00 GMT'

  later.minute.prev(d, 27);
  --> 'Fri, 22 Mar 2013 09:27:59 GMT'
</pre>

        </section>

        <!-- hour
        ================================================== -->
        <section id="hour">
          <div>
            <h2>Hour <small>(hour, h)</small></h2>
          </div>
          <p>Hours in a day, from 0 to 23.</p>
          <br/>
          <p>Using hours in a schedule:</p>
<pre>
  var sched = {schedules: [{h: [0, 5, 12]}]};
</pre>
          <br/>
          <p>Performing hours based calculations:</p>
<pre>
  var d = new Date('2013-03-22T10:02:05Z');

  later.hour.name;
  --> 'hour'

  later.hour.range;
  --> 3600

  later.hour.val(d);
  --> 10

  later.hour.isValid(d, 2);
  --> false

  later.hour.extent();
  --> [0, 23]

  later.hour.start(d);
  --> 'Fri, 22 Mar 2013 10:00:00 GMT'

  later.hour.end(d);
  --> 'Fri, 22 Mar 2013 10:59:59 GMT'

  later.hour.next(d, 5);
  --> 'Sat, 23 Mar 2013 05:00:00 GMT'

  later.hour.prev(d, 21);
  --> 'Thu, 21 Mar 2013 21:59:59 GMT'
</pre>

        </section>

        <!-- time
        ================================================== -->
        <section id="time">
          <div>
            <h2>Time <small>(time, t)</small></h2>
          </div>
          <p>Time of day, represented as seconds since midnight. From 0 to 86399.</p>
          <br/>
          <p>Using time in a schedule:</p>
<pre>
  var sched = {schedules: [{t: [6500]}]};
</pre>
          <br/>
          <p>Performing time based calculations:</p>
<pre>
  var d = new Date('2013-03-22T10:02:05Z');

  later.time.name;
  --> 'time'

  later.time.range;
  --> 1

  later.time.val(d);
  --> 36125

  later.time.isValid(d, 36125);
  --> true

  later.time.extent();
  --> [0, 86399]

  later.time.start(d);
  --> 'Fri, 22 Mar 2013 00:00:00 GMT'

  later.time.end(d);
  --> 'Fri, 22 Mar 2013 23:59:59 GMT'

  later.time.next(d, 60);
  --> 'Sat, 23 Mar 2013 00:01:00 GMT'

  later.time.prev(d, 60);
  --> 'Fri, 22 Mar 2013 00:01:00 GMT'
</pre>

        </section>

        <!-- day
        ================================================== -->
        <section id="day">
          <div>
            <h2>Day <small>(day, D)</small></h2>
          </div>
          <p>Days of a month, from 1 to max days in month. Specify 0 for the last
            day of the month.</p>
          <br/>
          <p>Using days in a schedule:</p>
<pre>
  var sched = {schedules: [{D: [0]}]};
</pre>
          <br/>
          <p>Performing day based calculations:</p>
<pre>
  var d = new Date('2013-03-22T10:02:05Z');

  later.day.name;
  --> 'day'

  later.day.range;
  --> 86400

  later.day.val(d);
  --> 22

  later.day.isValid(d, 3);
  --> false

  later.day.extent(d);
  --> [1, 31]

  later.day.start(d);
  --> 'Fri, 22 Mar 2013 00:00:00 GMT'

  later.day.end(d);
  --> 'Fri, 22 Mar 2013 23:59:59 GMT'

  later.day.next(d, 11);
  --> 'Thu, 11 Apr 2013 00:00:00 GMT'

  later.day.prev(d, 2);
  --> 'Sat, 02 Mar 2013 23:59:59 GMT'
</pre>


        <!-- day of week
        ================================================== -->
        <section id="day-of-week">
          <div>
            <h2>Day of week <small>(dayOfWeek, dw, d)</small></h2>
          </div>
          <p>Days of a week, from 1 to 7. Specify 0 for the last
            day of the week (Saturday).</p>
          <br/>
          <p>Using days of week in a schedule:</p>
<pre>
  var sched = {schedules: [{dw: [2,3,4,5,6]}]};
</pre>
          <br/>
          <p>Performing day of week based calculations:</p>
<pre>
  var d = new Date('2013-03-22T10:02:05Z');

  later.dayOfWeek.name;
  --> 'day of week'

  later.dayOfWeek.range;
  --> 86400

  later.dayOfWeek.val(d);
  --> 6

  later.dayOfWeek.isValid(d, 3);
  --> false

  later.dayOfWeek.extent();
  --> [1, 7]

  later.dayOfWeek.start(d);
  --> 'Fri, 22 Mar 2013 00:00:00 GMT'

  later.dayOfWeek.end(d);
  --> 'Fri, 22 Mar 2013 23:59:59 GMT'

  later.dayOfWeek.next(d, 1);
  --> 'Sun, 24 Mar 2013 00:00:00 GMT'

  later.dayOfWeek.prev(d, 5);
  --> 'Thu, 21 Mar 2013 23:59:59 GMT'
</pre>


        <!-- day of week count
        ================================================== -->
        <section id="day-of-week-count">
          <div>
            <h2>Day of week count <small>(dayOfWeekCount, dc)</small></h2>
          </div>
          <p>The nth day of the week within a month, from 1 to max weeks in a
            month. Specify 0 for the last day instance. Used together with
            the day of the week time period to specify things like
            the 2nd Tuesday or last Friday of a month.</p>
          <br/>
          <p>Using days of week count in a schedule:</p>
<pre>
  var sched = {schedules: [{dc: [2]}]};
</pre>
          <br/>
          <p>Performing day of week count based calculations:</p>
<pre>
  var d = new Date('2013-03-22T10:02:05Z');

  later.dayOfWeekCount.name;
  --> 'day of week count'

  later.dayOfWeekCount.range;
  --> 604800

  later.dayOfWeekCount.val(d);
  --> 4

  later.dayOfWeekCount.isValid(d, 4);
  --> true

  later.dayOfWeekCount.extent(d);
  --> [1, 5]

  later.dayOfWeekCount.start(d);
  --> 'Fri, 22 Mar 2013 00:00:00 GMT'

  later.dayOfWeekCount.end(d);
  --> 'Thu, 28 Mar 2013 23:59:59 GMT'

  // zero is special cased and means the last instance of
  // a day of the week in the month, instead of meaning the
  // first day of the week with the highest instance count
  // which would have been Mar 29 with value 5.
  later.dayOfWeekCount.next(d, 0);
  --> 'Mon, 25 Mar 2013 00:00:00 GMT'

  later.dayOfWeekCount.prev(d, 2);
  --> 'Thu, 14 Mar 2013 23:59:59 GMT'
</pre>

        <!-- day of year
        ================================================== -->
        <section id="day-of-year">
          <div>
            <h2>Day of year <small>(dayOfYear, dy)</small></h2>
          </div>
          <p>Days in a year, from 1 to max days in year. Specify 0 for last
            day of the year.</p>
          <br/>
          <p>Using days of year in a schedule:</p>
<pre>
  var sched = {schedules: [{dy: [189, 267]}]};
</pre>
          <br/>
          <p>Performing day of year based calculations:</p>
<pre>
  var d = new Date('2013-03-22T10:02:05Z');

  later.dayOfYear.name;
  --> 'day of year'

  later.dayOfYear.range;
  --> 86400

  later.dayOfYear.val(d);
  --> 81

  later.dayOfYear.isValid(d, 4);
  --> false

  later.dayOfYear.extent(d);
  --> [1, 365]

  later.dayOfYear.start(d);
  --> 'Fri, 22 Mar 2013 00:00:00 GMT'

  later.dayOfYear.end(d);
  --> 'Fri, 22 Mar 2013 23:59:59 GMT'

  later.dayOfYear.next(d, 256);
  --> 'Fri, 13 Sep 2013 00:00:00 GMT'

  later.dayOfYear.prev(d, 44);
  --> 'Wed, 13 Feb 2013 23:59:59 GMT'
</pre>
















        <!-- month
        ================================================== -->
        <section id="month">
          <div>
            <h2>Month <small>(month, M)</small></h2>
          </div>
          <p>Months of the year, from 1 to 12. Specify 0 for the last
            month of the year.</p>
          <br/>
          <p>Using months in a schedule:</p>
<pre>
  var sched = {schedules: [{M: [3,5,7]}]};
</pre>
          <br/>
          <p>Performing months based calculations:</p>
<pre>
  var d = new Date('2013-03-22T10:02:05Z');

  later.month.name;
  --> 'month'

  later.month.range;
  --> 2629740

  later.month.val(d);
  --> 3

  later.month.isValid(d, 3);
  --> true

  later.month.extent();
  --> [1, 12]

  later.month.start(d);
  --> 'Fri, 01 Mar 2013 00:00:00 GMT'

  later.month.end(d);
  --> 'Sun, 31 Mar 2013 23:59:59 GMT'

  later.month.next(d, 11);
  --> 'Fri, 01 Nov 2013 00:00:00 GMT'

  later.month.prev(d, 2);
  --> 'Thu, 28 Feb 2013 23:59:59 GMT'
</pre>


        <!-- year
        ================================================== -->
        <section id="year">
          <div>
            <h2>Year <small>(year, Y)</small></h2>
          </div>
          <p>Years, from 1970 to 2099.</p>
          <br/>
          <p>Using years in a schedule:</p>
<pre>
  var sched = {schedules: [{Y: [2013, 2014, 2015]}]};
</pre>
          <br/>
          <p>Performing years based calculations:</p>
<pre>
  var d = new Date('2013-03-22T10:02:05Z');

  later.year.name;
  --> 'year'

  later.year.range;
  --> 31556900

  later.year.val(d);
  --> 2013

  later.year.isValid(d, 2013);
  --> true

  later.year.extent();
  --> [1970, 2099]

  later.year.start(d);
  --> 'Tue, 01 Jan 2013 00:00:00 GMT'

  later.year.end(d);
  --> 'Tue, 31 Dec 2013 23:59:59 GMT'

  later.year.next(d, 2014);
  --> 'Wed, 01 Jan 2014 00:00:00 GMT'

  later.year.prev(d, 2012);
  --> 'Mon, 31 Dec 2012 23:59:59 GMT'
</pre>

        </section>


        <!-- custom
        ================================================== -->
        <section id="custom">
          <div>
            <h2>Writing a custom time period</h2>
          </div>
          <p>Custom modifiers are very similar to custom time periods and share
            the same interface. To keep things simple, we'll walk through creating a modifier
            to change the <code>month</code> period to work with values 0-11 instead of 1-12.</p>
          <br/>
          <p>The first step is to create a name and id for the modifier and add
            it to the <i>modifier</i> namespace. Modifiers take the time period
            that is being modified along with the specified values as arguments.</p>
<pre>
  later.modifier.month = later.modifier.m = function(period, values) {
    if(period.name !== 'month') {
      throw new Error('Month modifier only works with months!');
    }

    return {
      // interface implementation goes here
    };
  };
</pre>
          <br/>
          <p>Next, we need to implement the same interface that time periods
            implement and modify them to work with the new set of values.
            First we will just modify the <i>name</i> to include a reference to
            the modifier.</p>
<pre>
  name: 'reIndexed ' + period.name,
</pre>
          <br/>
          <p>The <i>range</i> is the same, so we just pass it through.</p>
<pre>
  range: period.range,
</pre>
          <br/>
          <p>We then modify the <i>val</i> returned by subtracting 1 since our
            new indicies are one less than the original ones.</p>
<pre>
  val: function(d) { return period.val(d) - 1; },
</pre>
          <br/>
          <p>Next, <i>isValid</i> is modified by tweaking the value that is passed
            in so that it is in the range that the month time period expects.</p>
<pre>
  isValid: function(d, val) { return period.isValid(d, val+1); },
</pre>
          <br/>
          <p>The <i>extent</i> also needs to be modified to reflect the new extent that
            goes from 0-11. Now that the extent starts at 0, the schedule engine
            will no longer assume that a 0 value means 'last'. There is nothing else
            that we need to do to correct for that behavior.</p>
<pre>
  extent: function(d) { return [0, 11]; },
</pre>
          <br/>
          <p>The <i>start</i> and <i>end</i> dates for the month will be the same, so we can
            just pass those through to the time period without modification.</p>
<pre>
  start: period.start,
  end: period.end,
</pre>
          <br/>
          <p>Finally, the values passed into <i>next</i> and <i>prev</i> need to
           be updated to be in the range that the month time period expects.</p>
<pre>
  next: function(d, val) { return period.next(d, val+1); },
  prev: function(d, val) { return period.prev(d, val+1); }
</pre>
        <br/>
        <h4>Full implementation</h4>
        <p>Here is the code for the completed example. To use the modifier, just
          add this code after including Later into your project and before you
          use it in any schedules.</p>
<pre>
  later.modifier.month = later.modifier.m = function(period, values) {
    if(period.name !== 'month') {
      throw new Error('Month modifier only works with months!');
    }

    return {
      name:     'reIndexed ' + period.name,
      range:    period.range,
      val:      function(d) { return period.val(d) - 1; },
      isValid:  function(d, val) { return period.isValid(d, val+1); },
      extent:   function(d) { return [0, 11]; },
      start:    period.start,
      end:      period.end,
      next:     function(d, val) { return period.next(d, val+1); },
      prev:     function(d, val) { return period.prev(d, val+1); }
    };
  };
</pre>
        <br/>
        <h4>Usage</h4>
        <p>Using the custom modifier is exactly the same as using a built-in
          modifier.</p>
<pre>
  // use our new modifier so that 2 now means March
  // instead of February
  var sched = {schedules: [{M_m: [2]}]},
      next = later.schedule(sched).next(1, new Date(2013, 3, 21));

  console.log(next.toUTCString());
  --> Sat, 01 Mar 2014 00:00:00 GMT
</pre>

        </section>

      </div>
    </div>

  </div>



    <!-- Footer
    ================================================== -->
    <footer class="footer">
      <div class="container">
        <p>&copy; 2013 BunKat &nbsp; Later is licensed under the
          <a href="http://opensource.org/licenses/MIT">MIT license</a>.</p>
      </div>
    </footer>



    <!-- Javascript
    ================================================== -->
    <script src="assets/js/jquery-1.10.1.min.js"></script>
    <script src="assets/js/bootstrap.min.js"></script>
    <script>
      // side bar
      setTimeout(function () {
        $('.later-sidenav').affix({
          offset: {
            top: function () { return $(window).width() <= 980 ? 230 : 150 }
          , bottom: 270
          }
        })
      }, 100);
    </script>

  </body>
</html>
