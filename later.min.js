later=function(){var t={version:"0.1.0"};return Array.prototype.indexOf||(Array.prototype.indexOf=function(t){"use strict";if(null==this)throw new TypeError;var e=Object(this),n=e.length>>>0;if(0===n)return-1;var r=0;if(arguments.length>1&&(r=Number(arguments[1]),r!=r?r=0:0!=r&&1/0!=r&&r!=-1/0&&(r=(r>0||-1)*Math.floor(Math.abs(r)))),r>=n)return-1;for(var a=r>=0?r:Math.max(n-Math.abs(r),0);n>a;a++)if(a in e&&e[a]===t)return a;return-1}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),t.array={},t.array.sort=function(t,e){t.sort(function(t,e){return+t-+e}),e&&0===t[0]&&t.push(t.shift())},t.array.next=function(t,e,n){for(var r,a=0===n[0]?0:n[1],u=e[0]||a,o=e.length-1;o>-1;--o){r=e[o]||a;{if(!(r>t)){if(r===t)return r;break}u=r}}return n[1]>=u?u:e[0]||a},t.array.nextInvalid=function(t,e,n){for(var r=n[0],a=n[1],u=e.length,o=0===e[u-1]&&0!==r?a:0,i=t,v=e.indexOf(t),d=i;i===(e[v]||o);)if(i++,i>a&&(i=r),v++,v===u&&(v=0),i===d)return void 0;return i},t.array.prev=function(t,e,n){for(var r,a=e.length,u=0===n[0]?0:n[1],o=e[a-1]||u,i=0;a>i;i++){r=e[i]||u;{if(!(t>r)){if(r===t)return r;break}o=r}}return o},t.array.prevInvalid=function(t,e,n){for(var r=n[0],a=n[1],u=e.length,o=0===e[u-1]&&0!==r?a:0,i=t,v=e.indexOf(t);i===(e[v]||o);)i--,r>i&&(i=a),v--,-1===v&&(v=u-1);return i},t.array.minIndex=function(t){for(var e=t[0],n=0,r=1;t.length>r;r++)e>t[r]&&(e=t[r],n=r);return n},t.array.maxIndex=function(t){for(var e=t[0],n=0,r=1;t.length>r;r++)t[r]>e&&(e=t[r],n=r);return n},t.day=t.D={name:"day",range:86400,val:function(e){return e.D||(e.D=t.date.getDate.call(e))},extent:function(e){if(e.DExtent)return e.DExtent;var n=t.M.val(e),r=t.date.daysInMonth[n];return 2===n&&366===t.dy.val(e)&&(r+=1),e.DExtent=[1,r]},start:function(e){return e.DStart||(e.DStart=t.date.next(t.Y.val(e),t.M.val(e),t.D.val(e)))},end:function(e){return e.DEnd||(e.DEnd=t.date.prev(t.Y.val(e),t.M.val(e),t.D.val(e)))},next:function(e,n){var r=t.date.nextRollover(e,n,t.D,t.M),a=t.D.extent(r)[1];return n=n>a?1:n,t.date.next(t.Y.val(r),t.M.val(r),n)},prev:function(e,n){var r=t.date.prevRollover(e,n,t.D,t.M),a=t.D.extent(r)[1];return n=n>a?a:n,t.date.prev(t.Y.val(r),t.M.val(r),n)}},t.dayOfWeekCount=t.dc={name:"day of week count",range:604800,val:function(e){return e.dc||(e.dc=Math.floor((t.D.val(e)-1)/7)+1)},extent:function(e){return e.dcExtent||(e.dcExtent=[1,Math.ceil(t.D.extent(e)[1]/7)])},start:function(e){return e.dcStart||(e.dcStart=t.date.next(t.Y.val(e),t.M.val(e),Math.max(1,7*(t.dc.val(e)-1)+1||1)))},end:function(e){return e.dcEnd||(e.dcEnd=t.date.prev(t.Y.val(e),t.M.val(e),Math.min(7*t.dc.val(e),t.D.extent(e)[1])))},next:function(e,n){var r=t.date.nextRollover(e,n,t.dc,t.M),a=t.dc.extent(r)[1];return n=n>a?1:n,t.date.next(t.Y.val(r),t.M.val(r),1+7*(n-1))},prev:function(e,n){var r=t.date.prevRollover(e,n,t.dc,t.M),a=t.dc.extent(r)[1];return n=n>a?a:n,t.dc.end(t.date.prev(t.Y.val(r),t.M.val(r),1+7*(n-1)))}},t.dayOfWeek=t.dw=t.d={name:"day of week",range:86400,val:function(e){return e.dw||(e.dw=t.date.getDay.call(e)+1)},extent:function(){return[1,7]},start:function(e){return t.D.start(e)},end:function(e){return t.D.end(e)},next:function(e,n){return t.date.next(t.Y.val(e),t.M.val(e),t.D.val(e)+(n-t.dw.val(e))+(t.dw.val(e)>=n?7:0))},prev:function(e,n){return t.date.prev(t.Y.val(e),t.M.val(e),t.D.val(e)+(n-t.dw.val(e))+(n>=t.dw.val(e)?-7:0))}},t.dayOfYear=t.dy={name:"day of year",range:86400,val:function(e){return e.dy||(e.dy=Math.ceil(1+(t.D.start(e).getTime()-t.Y.start(e).getTime())/t.DAY))},extent:function(e){var n=t.Y.val(e);return e.dyExtent||(e.dyExtent=[1,n%4?365:366])},start:function(e){return t.D.start(e)},end:function(e){return t.D.end(e)},next:function(e,n){var r=t.date.nextRollover(e,n,t.dy,t.Y),a=t.dy.extent(r)[1];return n=n>a?1:n,t.date.next(t.Y.val(r),t.M.val(r),n)},prev:function(e,n){var r=t.date.prevRollover(e,n,t.dy,t.Y),a=t.dy.extent(r)[1];return n=n>a?a:n,t.date.prev(t.Y.val(r),t.M.val(r),n)}},t.hour=t.h={name:"hour",range:3600,val:function(e){return e.h||(e.h=t.date.getHour.call(e))},extent:function(){return[0,23]},start:function(e){return e.hStart||(e.hStart=t.date.next(t.Y.val(e),t.M.val(e),t.D.val(e),t.h.val(e)))},end:function(e){return e.hEnd||(e.hEnd=t.date.prev(t.Y.val(e),t.M.val(e),t.D.val(e),t.h.val(e)))},next:function(e,n){var r=t.date.next(t.Y.val(e),t.M.val(e),t.D.val(e)+(t.h.val(e)>=n?1:0),n);return!t.option.UTC&&r.getTime()<=e.getTime()&&(r=t.date.next(t.Y.val(r),t.M.val(r),t.D.val(r),n+1)),r},prev:function(e,n){return t.date.prev(t.Y.val(e),t.M.val(e),t.D.val(e)+(n>=t.h.val(e)?-1:0),n)}},t.minute=t.m={name:"minute",range:60,val:function(e){return e.m||(e.m=t.date.getMin.call(e))},extent:function(){return[0,59]},start:function(e){return e.mStart||(e.mStart=t.date.next(t.Y.val(e),t.M.val(e),t.D.val(e),t.h.val(e),t.m.val(e)))},end:function(e){return e.mEnd||(e.mEnd=t.date.prev(t.Y.val(e),t.M.val(e),t.D.val(e),t.h.val(e),t.m.val(e)))},next:function(e,n){var r=t.date.next(t.Y.val(e),t.M.val(e),t.D.val(e),t.h.val(e)+(t.m.val(e)>=n?1:0),n);return!t.option.UTC&&r.getTime()<=e.getTime()&&(r=t.date.next(t.Y.val(r),t.M.val(r),t.D.val(r),t.h.val(r),n+120)),r},prev:function(e,n){return t.date.prev(t.Y.val(e),t.M.val(e),t.D.val(e),t.h.val(e)+(n>=t.m.val(e)?-1:0),n)}},t.month=t.M={name:"month",range:2629740,val:function(e){return e.M||(e.M=t.date.getMonth.call(e)+1)},extent:function(){return[1,12]},start:function(e){return e.MStart||(e.MStart=t.date.next(t.Y.val(e),t.M.val(e)))},end:function(e){return e.MEnd||(e.MEnd=t.date.prev(t.Y.val(e),t.M.val(e)))},next:function(e,n){return t.date.next(t.Y.val(e)+(t.M.val(e)>=n?1:0),n)},prev:function(e,n){return t.date.prev(t.Y.val(e)-(n>=t.M.val(e)?1:0),n)}},t.second=t.s={name:"second",range:1,val:function(e){return e.s||(e.s=t.date.getSec.call(e))},extent:function(){return[0,59]},start:function(t){return t},end:function(t){return t},next:function(e,n){var r=t.date.next(t.Y.val(e),t.M.val(e),t.D.val(e),t.h.val(e),t.m.val(e)+(t.s.val(e)>=n?1:0),n);return!t.option.UTC&&r.getTime()<=e.getTime()&&(r=t.date.next(t.Y.val(r),t.M.val(r),t.D.val(r),t.h.val(r),t.m.val(r),n+7200)),r},prev:function(e,n){return t.date.prev(t.Y.val(e),t.M.val(e),t.D.val(e),t.h.val(e),t.m.val(e)+(n>=t.s.val(e)?-1:0),n)}},t.time=t.t={name:"time",range:86400,val:function(e){return e.t||(e.t=3600*t.h.val(e)+60*t.m.val(e)+t.s.val(e))},extent:function(){return[0,86399]},start:function(t){return t},end:function(t){return t},next:function(e,n){var r=t.date.next(t.Y.val(e),t.M.val(e),t.D.val(e)+(t.t.val(e)>=n?1:0),0,0,n);return!t.option.UTC&&r.getTime()<e.getTime()&&(r=t.date.next(t.Y.val(r),t.M.val(r),t.D.val(r),t.h.val(r),t.m.val(r),n+7200)),r},prev:function(e,n){return t.date.next(t.Y.val(e),t.M.val(e),t.D.val(e)+(n>=t.t.val(e)?-1:0),0,0,n)}},t.weekOfMonth=t.wm={name:"week of month",range:604800,val:function(e){return e.wm||(e.wm=(t.D.val(e)+(t.dw.val(t.M.start(e))-1)+(7-t.dw.val(e)))/7)},extent:function(e){return e.wmExtent||(e.wmExtent=[1,(t.D.extent(e)[1]+(t.dw.val(t.M.start(e))-1)+(7-t.dw.val(t.M.end(e))))/7])},start:function(e){return e.wmStart||(e.wmStart=t.date.next(t.Y.val(e),t.M.val(e),Math.max(t.D.val(e)-t.dw.val(e)+1,1)))},end:function(e){return e.wmEnd||(e.wmEnd=t.date.prev(t.Y.val(e),t.M.val(e),Math.min(t.D.val(e)+(7-t.dw.val(e)),t.D.extent(e)[1])))},next:function(e,n){var r=t.date.nextRollover(e,n,t.wm,t.M),a=t.wm.extent(r)[1];return n=n>a?1:n,t.date.next(t.Y.val(r),t.M.val(r),Math.max(1,7*(n-1)-(t.dw.val(r)-2)))},prev:function(e,n){var r=t.date.prevRollover(e,n,t.wm,t.M),a=t.wm.extent(r)[1];return n=n>a?a:n,t.wm.end(t.date.next(t.Y.val(r),t.M.val(r),Math.max(1,7*(n-1)-(t.dw.val(r)-2))))}},t.weekOfYear=t.wy={name:"week of year (ISO)",range:604800,val:function(e){if(e.wy)return e.wy;var n=t.dw.next(t.wy.start(e),5),r=t.dw.next(t.Y.prev(n,t.Y.val(n)-1),5);return e.wy=1+Math.ceil((n.getTime()-r.getTime())/t.WEEK)},extent:function(e){if(e.wyExtent)return e.wyExtent;var n=t.dw.next(t.wy.start(e),5),r=t.dw.val(t.Y.start(n)),a=t.dw.val(t.Y.end(n));return e.wyExtent=[1,5===r||5===a?53:52]},start:function(e){return e.wyStart||(e.wyStart=t.date.next(t.Y.val(e),t.M.val(e),t.D.val(e)-(t.dw.val(e)>1?t.dw.val(e)-2:6)))},end:function(e){return e.wyEnd||(e.wyEnd=t.date.prev(t.Y.val(e),t.M.val(e),t.D.val(e)+(t.dw.val(e)>1?8-t.dw.val(e):0)))},next:function(e,n){var r=t.dw.next(t.wy.start(e),5),a=t.date.nextRollover(r,n,t.wy,t.Y);1!==t.wy.val(a)&&(a=t.dw.next(a,2));var u=t.wy.extent(a)[1],o=t.wy.start(a);return n=n>u?1:n,t.date.next(t.Y.val(o),t.M.val(o),t.D.val(o)+7*(n-1))},prev:function(e,n){var r=t.dw.next(t.wy.start(e),5),a=t.date.prevRollover(r,n,t.wy,t.Y);1!==t.wy.val(a)&&(a=t.dw.next(a,2));var u=t.wy.extent(a)[1],o=t.wy.end(a);return n=n>u?u:n,t.wy.end(t.date.next(t.Y.val(o),t.M.val(o),t.D.val(o)+7*(n-1)))}},t.year=t.Y={name:"year",range:31556900,val:function(e){return e.Y||(e.Y=t.date.getYear.call(e))},extent:function(){return[1970,2999]},start:function(e){return e.YStart||(e.YStart=t.date.next(t.Y.val(e)))},end:function(e){return e.YEnd||(e.YEnd=t.date.prev(t.Y.val(e)))},next:function(e,n){return n>t.Y.val(e)?t.date.next(n):void 0},prev:function(e,n){return t.Y.val(e)>n?t.date.prev(n):void 0}},t.modifier={},t.modifier.after=t.modifier.a=function(t,e){return{name:"after "+t.name,range:t.range,val:function(n){var r=t.val(n);return r>=e?e:r},extent:t.extent,start:t.start,end:t.end,next:function(n,r){return r>e&&(r=t.extent(n)[0]),t.next(n,r)},prev:function(n,r){return r>=e&&(r=t.extent(n)[1]),t.prev(n,r)}}},t.modifier.before=t.modifier.b=function(t,e){return{name:"before "+t.name,range:t.range,val:function(n){var r=t.val(n);return e>=r?e:r},extent:t.extent,start:t.start,end:t.end,next:function(n,r){return e>=r&&(r=t.extent(n)[0]),t.next(n,r)},prev:function(n,r){return e>r&&(r=t.extent(n)[1]),t.prev(n,r)}}},t.option={maxYear:2025,minYear:2005},t.compile=function(e){function n(t){return"next"===t?function(t,e){return t>e}:function(t,e){return e>t}}var r,a=[],u=0;for(var o in e){var i=o.split("_"),v=i[0],d=i[1],l=e[o],f=d?t.modifier[d](t[v],l[0]):t[v];a.push({constraint:f,vals:l}),u++}return a.sort(function(t,e){return t.constraint.range<e.constraint.range}),r=a[u-1].constraint,{start:function(e,n){for(var o=n,i=t.array[e],v=!1;!v&&o;){v=!0;for(var d=0;u>d;d++){var l=a[d].constraint,f=l.val(o),c=a[d].vals,s=l.extent(o),h=i(f,c,s);if(f!==h){o=l[e](o,h),v=!1;break}}}return r.start(o)},end:function(e,r){e="next";for(var o,i=t.array[e+"Invalid"],v=n(e),d=u-1;d>=0;d--){var l,f=a[d].constraint,c=f.val(r),s=a[d].vals,h=f.extent(r),x=i(c,s,h);x===c?l=r:x&&(l=f[e](r,x)),!l||o&&!v(o,l)||(o=l)}return o},tick:function(e,n){return new Date("next"===e?r.end(n).getTime()+t.SEC:r.start(n).getTime()-t.SEC)}}},t.instancesOf=function(e){function n(t,e,n,a,u){var o=n?new Date(n):new Date,i=r(t,e,o,a,u);return 0===i.length?void 0:1===e?i[0]:i}function r(t,e,n,r,l){var f,c=d(t),s=v(t),h=[],x=[];for(i(t,h,n);e--;){for(;f=h[c(h)];){if(r&&s(f.getTime(),r.getTime())){f=null;break}var p=u(t,f);{if(!p){x.push(l?[new Date(f),new Date(a(t,h,f))]:new Date(f)),o(t,h,f);break}i(t,h,p)}}if(!f)break}return x}function a(t,e,n){for(var r,a=v(t),u=0;f>u;u++)if(e[u]&&e[u].getTime()===n.getTime()){var o=l[u].end(t,n);(!r||a(o,r))&&(r=o)}for(var i=0;s>i;i++){var d=c[i].start(t,n);a(r,d)&&(r=d)}return new Date(r)}function u(t,e){var n,r=v(t);if(s)for(var a=0;s>a;a++)if(c[a].start(t,e).getTime()<=e.getTime()){var u=c[a].end(t,e);n=!n||r(u,n)?u:n}return n}function o(t,e,n){for(var r=0;f>r;r++)e[r]&&e[r].getTime()===n.getTime()&&(e[r]=l[r].start(t,l[r].tick(t,n)))}function i(t,e,n){for(var r=v(t),a=0;f>a;a++)(!e[a]||r(n,e[a]))&&(e[a]=l[a].start(t,n))}function v(t){return"next"===t?function(t,e){return t>e}:function(t,e){return e>t}}function d(e){return"next"===e?t.array.minIndex:t.array.maxIndex}for(var l=[],f=e.schedules.length,c=[],s=e.exceptions?e.exceptions.length:0,h=0;f>h;h++)l.push(t.compile(e.schedules[h]));for(var x=0;s>x;x++)c.push(t.compile(e.exceptions[x]));return{isValid:function(t){return void 0!==this.next(1,t,t)},next:function(t,e,r){return n("next",t||1,e,r)},prev:function(t,e,r){return n("prev",t||1,e,r)},nextRange:function(t,e,r){return n("next",t||1,e,r,!0)},prevRange:function(t,e,r){return n("prev",t||1,e,r,!0)}}},t.date={},t.date.UTC=function(){t.date.build=function(t,e,n,r,a,u){return new Date(Date.UTC(t,e,n,r,a,u))},t.date.getYear=Date.prototype.getUTCFullYear,t.date.getMonth=Date.prototype.getUTCMonth,t.date.getDate=Date.prototype.getUTCDate,t.date.getDay=Date.prototype.getUTCDay,t.date.getHour=Date.prototype.getUTCHours,t.date.getMin=Date.prototype.getUTCMinutes,t.date.getSec=Date.prototype.getUTCSeconds},t.date.localTime=function(){t.date.build=function(t,e,n,r,a,u){return new Date(t,e,n,r,a,u)},t.date.getYear=Date.prototype.getFullYear,t.date.getMonth=Date.prototype.getMonth,t.date.getDate=Date.prototype.getDate,t.date.getDay=Date.prototype.getDay,t.date.getHour=Date.prototype.getHours,t.date.getMin=Date.prototype.getMinutes,t.date.getSec=Date.prototype.getSeconds},t.date.UTC(),t.date.nextRollover=function(t,e,n,r){return n.val(t)>=e||e>n.extent(t)[1]?r.next(t,r.val(t)+1):r.start(t)},t.date.prevRollover=function(t,e,n,r){return e>=n.val(t)?r.start(r.prev(t,r.val(t)-1)):r.start(t)},t.date.daysInMonth=[0,31,28,31,30,31,30,31,31,30,31,30,31],t.SEC=1e3,t.MIN=60*t.SEC,t.HOUR=60*t.MIN,t.DAY=24*t.HOUR,t.WEEK=7*t.DAY,t.date.next=function(e,n,r,a,u,o){return t.date.build(e,void 0!==n?n-1:0,void 0!==r?r:1,a||0,u||0,o||0)},t.date.prev=function(e,n,r,a,u,o){var i=arguments.length;return n=2>i?11:n-1,r=3>i?t.D.extent(t.date.next(e,n+1))[1]:r,a=4>i?23:a,u=5>i?59:u,o=6>i?59:o,t.date.build(e,n,r,a,u,o)},t.parse={},t.parse.cron=function(){function t(t,e){return isNaN(t)?l[t]||null:+t+(e||0)}function e(t){var e,n={};for(e in t)"dc"!==e&&"d"!==e&&(n[e]=t[e].slice(0));return n}function n(t,e,n,r,a){var u=n;for(t[e]||(t[e]=[]);r>=u;)0>t[e].indexOf(u)&&t[e].push(u),u+=a||1}function r(t,r,a,u){(r.d&&!r.dc||r.dc&&0>r.dc.indexOf(u))&&(t.push(e(r)),r=t[t.length-1]),n(r,"d",a,a),n(r,"dc",u,u)}function a(t,e,r){var a={},u={};1===r?(n(e,"D",1,3),n(e,"d",l.MON,l.FRI),n(a,"D",2,2),n(a,"d",l.TUE,l.FRI),n(u,"D",3,3),n(u,"d",l.TUE,l.FRI)):(n(e,"D",r-1,r+1),n(e,"d",l.MON,l.FRI),n(a,"D",r-1,r-1),n(a,"d",l.MON,l.THU),n(u,"D",r+1,r+1),n(u,"d",l.TUE,l.FRI)),t.exceptions.push(a),t.exceptions.push(u)}function u(e,r,a,u,o,i){var v=e.split("/"),d=+v[1],l=v[0];if("*"!==l&&"0"!==l){var f=l.split("-");u=t(f[0],i),o=t(f[1],i)}n(r,a,u,o,d)}function o(e,o,i,v,d,l){var f,c,s=o.schedules,h=s[s.length-1];"L"===e&&(e=v-1),null!==(f=t(e,l))?n(h,i,f,f):null!==(f=t(e.replace("W",""),l))?a(o,h,f):null!==(f=t(e.replace("L",""),l))?r(s,h,f,v-1):2===(c=e.split("#")).length?(f=t(c[0],l),r(s,h,f,t(c[1]))):u(e,h,i,v,d,l)}function i(t){return t.indexOf("#")>-1||t.indexOf("L")>0}function v(t,e){return i(t)&&!i(e)?1:0}function d(t){var e,n,r,a,u={schedules:[{}],exceptions:[]},i=t.split(" ");for(e in f)if(n=f[e],r=i[n[0]],r&&"*"!==r&&"?"!==r){a=r.split(",").sort(v);var d,l=a.length;for(d=0;l>d;d++)o(a[d],u,e,n[1],n[2],n[3])}return u}var l={JAN:1,FEB:2,MAR:3,APR:4,MAY:5,JUN:6,JUL:7,AUG:8,SEP:9,OCT:10,NOV:11,DEC:12,SUN:1,MON:2,TUE:3,WED:4,THU:5,FRI:6,SAT:7},f={s:[0,0,59],m:[1,0,59],h:[2,0,23],D:[3,1,31],M:[4,1,12],Y:[6,1970,2099],d:[5,1,7,1]};return{parse:function(t,e){var n=t.toUpperCase();return d(e?n:"0 "+n)}}},t.parse.recur=function(){function t(t,l,f){if(t=u?"a"+t:t,e||(c.push({}),e=c[0]),e[t]||(e[t]=[]),n=e[t],a){for(r=[],v=l;f>=v;v+=a)r.push(v);d={n:t,x:a,c:n.length,m:f}}r=o?[l]:i?[f]:r;var s=r.length;for(v=0;s>v;v+=1)0>n.indexOf(r[v])&&n.push(r[v]);r=a=u=o=i=0}var e,n,r,a,u,o,i,v,d,l=[],f=[],c=l;return{schedules:l,exceptions:f,on:function(){return r=arguments[0]instanceof Array?arguments[0]:arguments,this},every:function(t){return a=t,this},after:function(t){return u=!0,r=[t],this},first:function(){return o=1,this},last:function(){return i=1,this},at:function(){r=arguments;for(var e=0,n=r.length;n>e;e++){var a=r[e].split(":");3>a.length&&(r[e]+=":00")}return t("t"),this},afterTime:function(){r=arguments;for(var e=0,n=r.length;n>e;e++){var a=r[e].split(":");3>a.length&&(r[e]+=":00")}return t("ta"),this},beforeTime:function(){r=arguments;for(var e=0,n=r.length;n>e;e++){var a=r[e].split(":");3>a.length&&(r[e]+=":00")}return t("tb"),this},second:function(){return t("s",0,59),this},minute:function(){return t("m",0,59),this},hour:function(){return t("h",0,23),this},dayOfMonth:function(){return t("D",1,i?0:31),this},dayOfWeek:function(){return t("d",1,7),this},onWeekend:function(){return r=[1,7],this.dayOfWeek()},onWeekday:function(){return r=[2,3,4,5,6],this.dayOfWeek()},dayOfWeekCount:function(){return t("dc",1,i?0:5),this},dayOfYear:function(){return t("dy",1,i?0:366),this},weekOfMonth:function(){return t("wm",1,i?0:5),this},weekOfYear:function(){return t("wy",1,i?0:53),this},month:function(){return t("M",1,12),this},year:function(){return t("Y",1970,2450),this},startingOn:function(t){return this.between(t,d.m)},between:function(n,r){return e[d.n]=e[d.n].splice(0,d.c),a=d.x,t(d.n,n,r),this},and:function(){return e=c[c.push({})-1],this},except:function(){return c=f,e=null,this}}},t.parse.text=function(){function e(t,e,n,r){return{startPos:t,endPos:e,text:n,type:r}}function n(t){var n,r,a,u,o,i,v=t instanceof Array?t:[t],d=/\s+/;for(v.push(d),o=p;!n||n.type===d;){i=-1,r=m.substring(o),n=e(o,o,m.split(d)[0]);var l,f=v.length;for(l=0;f>l;l++)u=v[l],a=u.exec(r),a&&0===a.index&&a[0].length>i&&(i=a[0].length,n=e(o,o+i,r.substring(0,i),u));n.type===d&&(o=n.endPos)}return n}function r(t){var e=n(t);return p=e.endPos,e}function a(t){for(var e=+c(t),n=l(y.through)?+c(t):e,r=[],a=e;n>=a;a++)r.push(a);return r}function u(t){for(var e=a(t);l(y.and);)e=e.concat(a(t));return e}function o(t){var e,n,r,a;l(y.weekend)?t.on(g.sun,g.sat).dayOfWeek():l(y.weekday)?t.on(g.mon,g.tue,g.wed,g.thu,g.fri).dayOfWeek():(e=c(y.rank),t.every(e),n=d(t),l(y.start)?(e=c(y.rank),t.startingOn(e),f(n.type)):l(y.between)&&(r=c(y.rank),l(y.and)&&(a=c(y.rank),t.between(r,a))))}function i(t){l(y.first)?t.first():l(y.last)?t.last():t.on(u(y.rank)),d(t)}function v(t){p=0,m=t,h=-1;for(var e=x();m.length>p&&0>h;){var n=f([y.every,y.after,y.onthe,y.on,y.of,y["in"],y.at,y.and,y.except,y.also]);switch(n.type){case y.every:o(e);break;case y.after:e.after(c(y.rank)),d(e);break;case y.onthe:i(e);break;case y.on:e.on(u(y.dayName)).dayOfWeek();break;case y.of:e.on(u(y.monthName)).month();break;case y["in"]:e.on(u(y.yearIndex)).year();break;case y.at:for(e.at(c(y.time));l(y.and);)e.at(c(y.time));break;case y.also:e.and();break;case y.except:e.except();break;default:h=p}}return{schedules:e.schedules,exceptions:e.exceptions,error:h}}function d(t){var e=f([y.second,y.minute,y.hour,y.dayOfYear,y.dayOfWeek,y.dayInstance,y.day,y.month,y.year,y.weekOfMonth,y.weekOfYear]);switch(e.type){case y.second:t.second();break;case y.minute:t.minute();break;case y.hour:t.hour();break;case y.dayOfYear:t.dayOfYear();break;case y.dayOfWeek:t.dayOfWeek();break;case y.dayInstance:t.dayOfWeekCount();break;case y.day:t.dayOfMonth();break;case y.weekOfMonth:t.weekOfMonth();break;case y.weekOfYear:t.weekOfYear();break;case y.month:t.month();break;case y.year:t.year();break;default:h=p}return e}function l(t){var e=n(t).type===t;return e&&r(t),e}function f(t){var e=r(t);return e.type?e.text=s(e.text,t):h=p,e}function c(t){return f(t).text}function s(t,e){var n=t;switch(e){case y.time:var r=t.split(/(:|am|pm)/),a="pm"===r[3]?parseInt(r[0],10)+12:r[0],u=r[2].trim();n=(1===a.length?"0":"")+a+":"+u;break;case y.rank:n=parseInt(/^\d+/.exec(t)[0],10);break;case y.monthName:case y.dayName:n=g[t.substring(0,3)]}return n}var h,x=t.parse.recur,p=0,m="",y={eof:/^$/,rank:/^((\d\d\d\d)|([2-5]?1(st)?|[2-5]?2(nd)?|[2-5]?3(rd)?|(0|[1-5]?[4-9]|[1-5]0|1[1-3])(th)?))\b/,time:/^((([0]?[1-9]|1[0-2]):[0-5]\d(\s)?(am|pm))|(([0]?\d|1\d|2[0-3]):[0-5]\d))\b/,dayName:/^((sun|mon|tue(s)?|wed(nes)?|thu(r(s)?)?|fri|sat(ur)?)(day)?)\b/,monthName:/^(jan(uary)?|feb(ruary)?|ma((r(ch)?)?|y)|apr(il)?|ju(ly|ne)|aug(ust)?|oct(ober)?|(sept|nov|dec)(ember)?)\b/,yearIndex:/^(\d\d\d\d)\b/,every:/^every\b/,after:/^after\b/,second:/^(s|sec(ond)?(s)?)\b/,minute:/^(m|min(ute)?(s)?)\b/,hour:/^(h|hour(s)?)\b/,day:/^(day(s)?( of the month)?)\b/,dayInstance:/^day instance\b/,dayOfWeek:/^day(s)? of the week\b/,dayOfYear:/^day(s)? of the year\b/,weekOfYear:/^week(s)?( of the year)?\b/,weekOfMonth:/^week(s)? of the month\b/,weekday:/^weekday\b/,weekend:/^weekend\b/,month:/^month(s)?\b/,year:/^year(s)?\b/,between:/^between (the)?\b/,start:/^(start(ing)? (at|on( the)?)?)\b/,at:/^(at|@)\b/,and:/^(,|and\b)/,except:/^(except\b)/,also:/(also)\b/,first:/^(first)\b/,last:/^last\b/,"in":/^in\b/,of:/^of\b/,onthe:/^on the\b/,on:/^on\b/,through:/(-|^(to|through)\b)/},g={jan:1,feb:2,mar:3,apr:4,may:5,jun:6,jul:7,aug:8,sep:9,oct:10,nov:11,dec:12,sun:1,mon:2,tue:3,wed:4,thu:5,fri:6,sat:7,"1st":1,fir:1,"2nd":2,sec:2,"3rd":3,thi:3,"4th":4,"for":4};return{parse:function(t){return v(t.toLowerCase())}}},t}();